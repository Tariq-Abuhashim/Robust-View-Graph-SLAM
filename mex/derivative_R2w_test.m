R = rand(3);

r1=R(1);r2=R(2);r3=R(3);
r4=R(4);r5=R(5);r6=R(6);
r7=R(7);r8=R(8);r9=R(9);
a = ((r2/2-r4/2)*(r2/2-r4/2)+(r3/2-r7/2)*(r3/2-r7/2)+(r6/2-r8/2)*(r6/2-r8/2));
a2= a^(3/2);
b = r1/2+r5/2+r9/2-1/2;
c = (r6/2-r8/2)*(sqrt(a)/2) / ((a+b*b)*sqrt(a));
d = (r3/2-r7/2)*(sqrt(a)/2) / ((a+b*b)*sqrt(a));
e = (r2/2-r4/2)*(sqrt(a)/2) / ((a+b*b)*sqrt(a));
f = (r2/2-r4/2)*atan2(sqrt(a),b)*(r6/2-r8/2) / (2*a2);
g = (r2/2-r4/2)*(r6/2-r8/2)*b / (2*(a+b*b)*a);
h = (r2/2-r4/2)*(r3/2-r7/2)*b / (2*(a+b*b)*a);
i = (r2/2-r4/2)*atan2(sqrt(a),b)*(r3/2-r7/2) / (2*a2);
j = atan2(sqrt(a),b) / (2*sqrt(a));
k = (r2/2-r4/2)*atan2(sqrt(a),b)*(r2/2-r4/2) / (2*a2);
l = (r2/2-r4/2)*(r2/2-r4/2)*b / (2*(a+b*b)*a);
m = (r3/2-r7/2)*atan2(sqrt(a),b)*(r6/2-r8/2) / (2*a2);
n = (r3/2-r7/2)*(r6/2-r8/2)*b / (2*(a+b*b)*a);
o = (r3/2-r7/2)*atan2(sqrt(a),b)*(r3/2-r7/2) / (2*a2);
p = (r3/2-r7/2)*(r3/2-r7/2)*b / (2*(a+b*b)*a);
q = (r3/2-r7/2)*atan2(sqrt(a),b)*(r2/2-r4/2)/(2*a2);
r = (r3/2-r7/2)*(r2/2-r4/2)*b / (2*(a+b*b)*a);
s = (r6/2-r8/2)*atan2(sqrt(a),b)*(r6/2-r8/2) / (2*a2);
t = (r6/2-r8/2)*(r6/2-r8/2)*b / (2*(a+b*b)*a);
u = (r6/2-r8/2)*(r3/2-r7/2)*b / (2*(a+b*b)*a);
v = (r6/2-r8/2)*atan2(sqrt(a),b)*(r3/2-r7/2) / (2*a2);
w = (r6/2-r8/2)*atan2(sqrt(a),b)*(r2/2-r4/2) / (2*a2);
x = (r6/2-r8/2)*(r2/2-r4/2)*b / (2*(a+b*b)*a);
y = (r3/2-r7/2)*atan2(sqrt(a),b)*(r2/2-r4/2) / (2*a2);
z =(r6/2 -r8/2)*(r3/2-r7/2)*b / (2*(a+b*b)*a);

af = ...
[c,...
-d,...
 e;
 f - g, ...
 h - i, ...
-j + k - l;
 m - n,...
 j - o + p, ...
 q - r;
 g - f, ...
 i - h, ...
 j - k + l;
 c, ...
-d, ...
 e;
-j + s - t, ...
 u - v, ...
 w - x;
 n - m, ...
-j + o - p, ...
 r - y;
 j - s + t, ...
 v - z, ...
 x - w;
 c, ...
-d, ...
 e];


r1=R(1);r2=R(2);r3=R(3);
r4=R(4);r5=R(5);r6=R(6);
r7=R(7);r8=R(8);r9=R(9);
dr1=[((r6/2 - r8/2)*(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2-r8/2)^2)^(1/2)/2))/(((((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 +...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)), ...
    -((r3/2 - r7/2)*(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 +...
    (r6/2-r8/2)^2)^(1/2)/2))/(((((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 +...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)), ...
    ((r2/2 - r4/2)*(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2-r8/2)^2)^(1/2)/2))/(((((r2/2 - r4/2)^2 +...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + ...
    (r1/2 + r5/2 +r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))];
dr2=[((r2/2 - r4/2)*atan2(((r2/2 - r4/2)^2 +(r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2),...
    r1/2 + r5/2 + r9/2 -1/2)*(r6/2 - r8/2))/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 +...
    (r6/2 - r8/2)^2)^(3/2)) - ...
    ((r2/2 - r4/2)*(r6/2-r8/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 +(r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 +r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 +(r6/2 - r8/2)^2)), ...
    ((r2/2 - r4/2)*(r3/2 - r7/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 +...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 +...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)) - ((r2/2 - r4/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r3/2 - r7/2))/(2*((r2/2 - r4/2)^2 +...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)), - atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)/(2*((r2/2 - r4/2)^2 +(r3/2 -r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)) + ...
    (r2/2 - r4/2)*atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 -r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)*(r2/2 - r4/2)/(2*((r2/2 -r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(3/2)) - ((r2/2 - r4/2)*(r2/2 - r4/2)*(r1/2 + r5/2 +r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 +(r6/2 -r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 -1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2))];
dr3=[((r3/2 - r7/2)*atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)*(r6/2 - r8/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(3/2)) - ((r3/2 - r7/2)*(r6/2 - r8/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 +(r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 -r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)),atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 -r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)/(2*((r2/2 - r4/2)^2 +(r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)) - ...
    ((r3/2 - r7/2)*atan2(((r2/2 - r4/2)^2 +(r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)*(r3/2 - r7/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(3/2)) + (abs(r3/2 - r7/2)*sign(r3/2 - ...
    r7/2)*(r3/2 - r7/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 +(r1/2 + r5/2 + ...
    r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)), ...
    (abs(r3/2 - r7/2)*sign(r3/2 - r7/2)*atan2(((r2/2 - r4/2)^2 +(r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + ...
    r9/2 - 1/2)*(r2/2 - r4/2))/(2*((r2/2 - r4/2)^2 + (r3/2 -r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(3/2)) - ((r3/2 -r7/2)*(r2/2 - r4/2)*(r1/2 + r5/2 + ...
    r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 +(r6/2 -r8/2)^2)^(1/2))^2 + ...
    (r1/2 + r5/2 + r9/2 -1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2))];
dr4=[ ((r2/2 - r4/2)*(r6/2 - r8/2)*(r1/2 + ...
    r5/2 + r9/2 - 1/2))/(2*((  ...
     ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 - ...
    r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 - ...
    r8/2)^2)) - ((r2/2 - r4/2)*atan2((abs(r2/2 - ...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)*(r6/2 - r8/2))/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)), (abs(r2/2 - ...
    r4/2)*sign(r2/2 - r4/2)*atan2(((r2/2 - r4/2)^2 + abs(r3/2 - ...
    r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - ...
    1/2)*(r3/2 - r7/2))/(2*((r2/2 - r4/2)^2 + abs(r3/2 - ...
    r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)) - (abs(r2/2 - ...
    r4/2)*sign(r2/2 - r4/2)*(r3/2 - r7/2)*(r1/2 + ...
    r5/2 + r9/2 - 1/2))/(2*((  ...
     ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 - ...
    r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 - ...
    r8/2)^2)), atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2)) - ((r2/2 - r4/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 ...
    - 1/2)*(r2/2 - r4/2))/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)) + ...
    ((r2/2 - r4/2)*(r2/2 - r4/2)*(r1/2 + r5/2 + ...
    r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 ...
    + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2))];
dr5=[ ((r6/2 - r8/2)*(((r2/2 -...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)/2))/(((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 +...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 -...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 -...
    r8/2)^2)^(1/2)), -((r3/2 - r7/2)*(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 -...
    r8/2)^2)^(1/2)/2))/((((abs(r2/2 -...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 ...
    + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + abs(r3/2 -...
    r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)), ((r2/2 - r4/2)*(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 +...
    (r6/2 - r8/2)^2)^(1/2)/2))/(((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 +...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 +...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))];
dr6=[ - atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)) + ...
    ((r6/2 - r8/2)*atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r6/2 - ...
    r8/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)) - ((r6/2 - r8/2)*(r6/2 - ...
    r8/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*(( ...
      ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)), ...
    (abs(r6/2 - r8/2)*sign(r6/2 - r8/2)*(r3/2 - r7/2)*(r1/2 + r5/2 ...
    + r9/2 - 1/2))/(2*((   (abs(r2/2 ...
    - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + ...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)) - ((r6/2 - r8/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)*(r3/2 - r7/2))/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)), ...
    ((r6/2 - r8/2)*atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r2/2 - ...
    r4/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)) - ... 
    ((r6/2 - r8/2)*(r2/2 - r4/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*(( ...
    ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2))];
dr7=[ (abs(r3/2 - r7/2)*sign(r3/2 - r7/2)*(r6/2 - r8/2)*(r1/2 + ...
    r5/2 + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 ...
    + (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)) - ((r3/2 - r7/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)*(r6/2 - r8/2))/(2*((r2/2 - ...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)), ...
    -atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + abs(r6/2 - r8/2)^2)^(1/2), ...
    r1/2 + r5/2 + r9/2 - 1/2)/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)) + ((r3/2 - r7/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r3/2 - ...
    r7/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2)) - ((r3/2 - r7/2)*(r3/2 - ...
    r7/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)), ...
    ((r3/2 - r7/2)*(r2/2 - r4/2)*(r1/2 + r5/2 ...
    + r9/2 - 1/2))/(2*((((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + ...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)) - ((r3/2 - r7/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r2/2 - r4/2))/(2*((r2/2 - ...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2))];
dr8=[ atan2(((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 +(r6/2 - ...
    r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)/(2*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)) - ((r6/2 - r8/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r6/2 - ...
    r8/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(3/2)) + ((r6/2 - r8/2)*(r6/2 - r8/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*(( ...
    ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)), ...
    ((r6/2 - r8/2)*atan2(((r2/2 - r4/2)^2 + (r3/2 - ...
    r7/2)^2 + (r6/2 - r8/2)^2)^(1/2), r1/2 + r5/2 + r9/2 - 1/2)*(r3/2 - ...
    r7/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - ...
    r8/2)^2)^(3/2)) - ((r6/2 - r8/2)*(r3/2 - ...
    r7/2)*(r1/2 + r5/2 + r9/2 - 1/2))/(2*(( ...
      ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)), ...
    ((r6/2 - r8/2)*(r2/2 - r4/2)*(r1/2 + r5/2 ...
    + r9/2 - 1/2))/(2*((   ((r2/2 ...
    - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + ...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)) - ((r6/2 - r8/2)*atan2(((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 -  r8/2)^2)^(1/2), r1/2 + r5/2 + ...
    r9/2 - 1/2)*(r2/2 - r4/2))/(2*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(3/2))];
dr9=[ ((r6/2 - r8/2)*(   ((r2/2 - ...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)/2))/(((...
    ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 + r5/2 + r9/2 - ...
    1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - ...
    r8/2)^2)^(1/2)), -((r3/2 - r7/2)*(   ...
    ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - ...
    r8/2)^2)^(1/2)/2))/(((   ((r2/2 - ...
    r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + (r1/2 ...
    + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + (r3/2 - ...
    r7/2)^2 + (r6/2 - r8/2)^2)^(1/2)), ((r2/2 - r4/2)*( ...
      ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + ...
    (r6/2 - r8/2)^2)^(1/2)/2))/(((   ...
    ((r2/2 - r4/2)^2 + (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))^2 + ...
    (r1/2 + r5/2 + r9/2 - 1/2)^2)*((r2/2 - r4/2)^2 + ...
    (r3/2 - r7/2)^2 + (r6/2 - r8/2)^2)^(1/2))];
af - [dr1;dr2;dr3;dr4;dr5;dr6;dr7;dr8;dr9]